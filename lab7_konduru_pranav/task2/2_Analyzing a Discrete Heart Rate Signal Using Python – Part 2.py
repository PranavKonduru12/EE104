#!/usr/bin/env python
# coding: utf-8

# # Analyzing a Discrete Heart Rate Signal Using Python – Part 2

# ## Calculating Frequency Domain Measures
# First we create an evenly spaced timeline for the R-R intervals. To do this we take the sample position of all R-peaks, which is housed in the list dict[‘peaklist’] that we calculated in part 1. We then assign the y-values to these sample positions from the list dict[‘RR_list’], which contains the duration of all R-R intervals. Finally we interpolate the signal.

# Source: http://www.paulvangent.com/2016/03/21/analyzing-a-discrete-heart-rate-signal-using-python-part-2/ 

# In[45]:


import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import math

from scipy.interpolate import interp1d #Import the interpolate function from SciPy

# peaklist = [63,
#  165,
#  264,
#  360,
#  460,
#  565,
#  674,
#  773,
#  863,
#  953,
#  1048,
#  1156,
#  1272,
#  1385,
#  1487,
#  1592,
#  1698,
#  1803,
#  1897,
#  1994,
#  2097,
#  2206,
#  2308,
#  2406]

peaklist = [6,
 121,
 187,
 341,
 432,
 505,
 519,
 551,
 590,
 653,
 727,
 812,
 849,
 880,
 909,
 947,
 981,
 1013,
 1042,
 1077,
 1100,
 1186,
 1232,
 1251,
 1269,
 1313,
 1316,
 1319,
 1324,
 1338,
 1394,
 1409,
 1428,
 1517,
 1532,
 1574,
 1617,
 1650,
 1740,
 1873,
 1914,
 1917,
 1920,
 1927,
 1975,
 2003,
 2017,
 2039,
 2063,
 2121,
 2132,
 2157,
 2180,
 2196,
 2219,
 2223,
 2227,
 2233,
 2351,
 2362,
 2368,
 2431,
 2452,
 2484,
 2527,
 2579,
 2653,
 2767,
 2795,
 2818,
 2830,
 2858,
 2887,
 2897,
 2915,
 2972,
 3004,
 3064,
 3090,
 3093,
 3097,
 3102,
 3118,
 3173,
 3239,
 3242,
 3270,
 3278,
 3294,
 3309,
 3313,
 3335,
 3367,
 3461,
 3517,
 3556,
 3674,
 3694,
 3740,
 3751,
 3777,
 3834,
 3899,
 3906,
 3909,
 3945,
 3954,
 3958,
 3964,
 3969,
 3972,
 3992,
 4005,
 4019,
 4023,
 4028,
 4053,
 4057,
 4113,
 4149,
 4246,
 4290,
 4310,
 4359,
 4371,
 4380,
 4417,
 4457,
 4505,
 4593,
 4737,
 4818,
 4820,
 4828,
 4842,
 4870,
 4909,
 4941,
 4977,
 4987,
 5017,
 5029,
 5054,
 5094,
 5102,
 5107,
 5112,
 5123,
 5145,
 5152,
 5155,
 5163,
 5167,
 5176,
 5187,
 5196,
 5224,
 5229,
 5280,
 5387,
 5447,
 5488,
 5531,
 5574,
 5584,
 5617,
 5646,
 5717,
 5782,
 5799,
 5863,
 5904,
 5925,
 5932,
 5954,
 6011,
 6038,
 6073,
 6093,
 6097,
 6128,
 6171,
 6231,
 6308,
 6355,
 6395,
 6455,
 6542,
 6662,
 6679,
 6694,
 6713,
 6758,
 6778,
 6785,
 6824,
 6834,
 6838,
 6841,
 6848,
 6863,
 6878,
 6882,
 6922,
 6927,
 6980,
 7063,
 7097,
 7114,
 7143,
 7164,
 7203,
 7279,
 7310,
 7353,
 7398,
 7449,
 7495,
 7523,
 7569,
 7667,
 7691,
 7809,
 7824,
 7844,
 7869,
 7925,
 7928,
 7971,
 7987,
 8009,
 8013,
 8020,
 8024,
 8038,
 8042,
 8060,
 8078,
 8132,
 8217,
 8266,
 8302,
 8317,
 8357,
 8438,
 8555,
 8558,
 8568,
 8602,
 8633,
 8664,
 8722,
 8816,
 8825,
 8836,
 8843,
 8869,
 8875,
 8922,
 8972,
 9013,
 9088,
 9124,
 9129,
 9140,
 9147,
 9150,
 9156,
 9163,
 9168,
 9173,
 9211,
 9254,
 9296,
 9357,
 9435,
 9513,
 9522,
 9525,
 9528,
 9530,
 9564,
 9630,
 9714,
 9726,
 9732,
 9754,
 9847,
 9885,
 9919,
 9922,
 9924,
 9929,
 10040,
 10058,
 10101,
 10109,
 10121,
 10156,
 10198,
 10253,
 10300,
 10328,
 10472,
 10504,
 10537,
 10565,
 10598,
 10612,
 10634,
 10787,
 10800,
 10813,
 10818,
 10959,
 10998,
 11009,
 11118,
 11165,
 11198,
 11228,
 11328,
 11383,
 11447,
 11473,
 11508,
 11512,
 11583,
 11591,
 11618,
 11632,
 11655,
 11672,
 11732,
 11736,
 11750,
 11756,
 11767,
 11770,
 11781,
 11803,
 11824,
 11838,
 11875,
 11879,
 11886,
 11942,
 11996,
 12022,
 12053,
 12093,
 12140,
 12218,
 12365,
 12396,
 12425,
 12478,
 12507,
 12545,
 12617,
 12625,
 12669,
 12695,
 12700,
 12713,
 12731,
 12737,
 12803,
 12825,
 12938,
 12992,
 13020,
 13032,
 13088,
 13121,
 13235,
 13250,
 13256,
 13272,
 13311,
 13317,
 13352,
 13367,
 13389,
 13403,
 13418,
 13425,
 13447,
 13452,
 13497,
 13580,
 13585,
 13595,
 13603,
 13606,
 13622,
 13628,
 13655,
 13659,
 13664,
 13670,
 13689,
 13697,
 13701,
 13709,
 13713,
 13718,
 13724,
 13727,
 13747,
 13760,
 13768,
 13772,
 13782,
 13786,
 13869,
 13895,
 13927,
 13930,
 13934,
 13985,
 14026,
 14071,
 14170,
 14202,
 14208,
 14287,
 14290,
 14320,
 14400,
 14459,
 14467,
 14488,
 14494,
 14516,
 14520,
 14540,
 14543,
 14576,
 14710,
 14728,
 14738,
 14763,
 14778,
 14782,
 14799,
 14802,
 14881,
 14930,
 14958,
 15014,
 15046,
 15098,
 15130,
 15171,
 15184,
 15206,
 15210,
 15235,
 15238,
 15242,
 15300,
 15342,
 15370,
 15374,
 15437,
 15463,
 15469,
 15477,
 15508,
 15545,
 15563,
 15620,
 15623,
 15663,
 15695,
 15712,
 15725,
 15729,
 15808,
 15878,
 15887,
 15920,
 15970,
 16025,
 16072,
 16103,
 16284,
 16371,
 16444,
 16447,
 16465,
 16472,
 16479,
 16493,
 16503,
 16530,
 16559,
 16593,
 16616,
 16623,
 16632,
 16666,
 16689,
 16693,
 16697,
 16704,
 16709,
 16720,
 16733,
 16774,
 16843,
 16879,
 16923,
 16968,
 17020,
 17105,
 17110,
 17113,
 17120,
 17167,
 17185,
 17200,
 17220,
 17252,
 17305,
 17330,
 17341,
 17360,
 17368,
 17381,
 17428,
 17440,
 17485,
 17598,
 17627,
 17630,
 17683,
 17791,
 17824,
 17866,
 17930,
 17980,
 18026,
 18112,
 18126,
 18157,
 18173,
 18182,
 18185,
 18190,
 18207,
 18210,
 18214,
 18263,
 18304,
 18314,
 18321,
 18376,
 18414,
 18464,
 18485,
 18494,
 18542,
 18546,
 18582,
 18587,
 18600,
 18615,
 18653,
 18655,
 18659,
 18672,
 18678,
 18683,
 18779,
 18825,
 18870,
 18922,
 19052,
 19070,
 19074,
 19078,
 19140,
 19162,
 19169,
 19188,
 19191,
 19212,
 19217,
 19222,
 19228,
 19233,
 19244,
 19260,
 19264,
 19280,
 19295,
 19300,
 19306,
 19315,
 19345,
 19400,
 19403,
 19409,
 19414,
 19485,
 19503,
 19550,
 19588,
 19684,
 19717,
 19757,
 19819,
 19858,
 19891,
 20028,
 20079,
 20104,
 20165,
 20198,
 20225,
 20230,
 20234,
 20250,
 20260,
 20270,
 20317,
 20328,
 20357,
 20371,
 20374,
 20444,
 20511,
 20514,
 20552,
 20646,
 20652,
 20683,
 20727,
 20759,
 20790,
 20834,
 20910,
 20939,
 21010,
 21013,
 21058,
 21081,
 21088,
 21218,
 21237,
 21240,
 21245,
 21298,
 21313,
 21319,
 21323,
 21345,
 21382,
 21481,
 21520,
 21627,
 21668,
 21727,
 21807,
 21905,
 21952,
 21983,
 22124,
 22225,
 22250,
 22253,
 22273,
 22337,
 22385,
 22463,
 22495,
 22515,
 22556,
 22560,
 22568,
 22609,
 22658,
 22698,
 22740,
 22802,
 22838,
 22844,
 22865,
 22908,
 22953,
 22975,
 22989,
 22994,
 23018,
 23084,
 23122,
 23153,
 23171,
 23195,
 23200,
 23245,
 23267,
 23299,
 23323,
 23328,
 23377,
 23382,
 23463,
 23522,
 23576,
 23622,
 23675,
 23753,
 23793,
 23894,
 23928,
 23958,
 23988,
 24001,
 24014,
 24055,
 24160,
 24181,
 24189,
 24195,
 24213,
 24231,
 24238,
 24243,
 24258,
 24262,
 24264,
 24267,
 24274,
 24310,
 24328,
 24333,
 24336,
 24338,
 24350,
 24368,
 24428,
 24445,
 24462,
 24468,
 24556,
 24609,
 24653,
 24696,
 24781,
 24906,
 24920,
 24944,
 24952,
 24954,
 25067,
 25081,
 25088,
 25092,
 25123,
 25156,
 25161,
 25190,
 25209,
 25214,
 25218,
 25220,
 25227,
 25231,
 25300,
 25310,
 25343,
 25358,
 25393,
 25418,
 25478,
 25497,
 25535,
 25573,
 25632,
 25690,
 25750,
 25851,
 25869,
 25898,
 25944,
 25993,
 26020,
 26055,
 26099,
 26109,
 26123,
 26177,
 26183,
 26192,
 26245,
 26256,
 26266,
 26270,
 26318,
 26355,
 26370,
 26411,
 26429,
 26454,
 26459,
 26470,
 26502,
 26544,
 26559,
 26596,
 26627,
 26719,
 26778,
 26788,
 26790,
 26793,
 26845,
 26887,
 26890,
 26935,
 26938,
 26960,
 26994,
 26998,
 27005,
 27017,
 27035,
 27104,
 27203,
 27300,
 27345,
 27418,
 27469,
 27512,
 27568,
 27611,
 27643,
 27761,
 27803,
 27888,
 28015,
 28055,
 28087,
 28164,
 28206,
 28280,
 28305,
 28384,
 28394,
 28424,
 28466,
 28505,
 28568,
 28704,
 28772,
 28790,
 28839,
 28843,
 28881,
 28884,
 28923,
 28926,
 28988,
 29051,
 29087,
 29103,
 29124,
 29133,
 29153,
 29256,
 29327,
 29350,
 29380,
 29428,
 29482,
 29535,
 29544,
 29563,
 29650,
 29667,
 29693,
 29724,
 29754,
 29782,
 29830,
 29865,
 29873,
 29890,
 29894,
 29936,
 29958,
 29978,
 29990,
 29998,
 30003,
 30033,
 30036,
 30045,
 30078,
 30106,
 30140,
 30148,
 30151,
 30156,
 30159,
 30194,
 30196,
 30218,
 30231,
 30238,
 30255,
 30258,
 30261,
 30353,
 30396,
 30431,
 30463,
 30499,
 30605,
 30623,
 30673,
 30679,
 30688,
 30729,
 30738,
 30744,
 30747,
 30750,
 30834,
 30961,
 30976,
 31020,
 31063,
 31120,
 31182,
 31261,
 31267,
 31298,
 31342,
 31389,
 31465,
 31679,
 31714,
 31746,
 31803,
 31833,
 31861,
 31867,
 31953,
 31964,
 32020,
 32128,
 32133,
 32138,
 32141,
 32143,
 32146,
 32148,
 32151,
 32153,
 32156,
 32179,
 32191,
 32198,
 32236,
 32241,
 32244,
 32251,
 32282,
 32330,
 32367,
 32410,
 32418,
 32466,
 32498,
 32584,
 32645,
 32648,
 32651,
 32660,
 32756,
 32798,
 32853,
 32935,
 32966,
 32995,
 33017,
 33115,
 33176,
 33183,
 33231,
 33277,
 33335,
 33446,
 33550,
 33613,
 33673] 

# RR_list = [1020.0,
#  990.0,
#  960.0,
#  1000.0,
#  1050.0,
#  1090.0,
#  990.0,
#  900.0,
#  900.0,
#  950.0,
#  1080.0,
#  1160.0,
#  1130.0,
#  1020.0,
#  1050.0,
#  1060.0,
#  1050.0,
#  940.0,
#  970.0,
#  1030.0,
#  1090.0,
#  1020.0,
#  980.0]

RR_list = [1150.0,
 660.0,
 1540.0,
 910.0,
 730.0,
 140.0,
 320.0,
 390.0,
 630.0,
 740.0,
 850.0,
 370.0,
 310.0,
 290.0,
 380.0,
 340.0,
 320.0,
 290.0,
 350.0,
 230.0,
 860.0,
 460.0,
 190.0,
 180.0,
 440.0,
 30.0,
 30.0,
 50.0,
 140.0,
 560.0,
 150.0,
 190.0,
 890.0,
 150.0,
 420.0,
 430.0,
 330.0,
 900.0,
 1330.0,
 410.0,
 30.0,
 30.0,
 70.0,
 480.0,
 280.0,
 140.0,
 220.0,
 240.0,
 580.0,
 110.0,
 250.0,
 230.0,
 160.0,
 230.0,
 40.0,
 40.0,
 60.0,
 1180.0,
 110.0,
 60.0,
 630.0,
 210.0,
 320.0,
 430.0,
 520.0,
 740.0,
 1140.0,
 280.0,
 230.0,
 120.0,
 280.0,
 290.0,
 100.0,
 180.0,
 570.0,
 320.0,
 600.0,
 260.0,
 30.0,
 40.0,
 50.0,
 160.0,
 550.0,
 660.0,
 30.0,
 280.0,
 80.0,
 160.0,
 150.0,
 40.0,
 220.0,
 320.0,
 940.0,
 560.0,
 390.0,
 1180.0,
 200.0,
 460.0,
 110.0,
 260.0,
 570.0,
 650.0,
 70.0,
 30.0,
 360.0,
 90.0,
 40.0,
 60.0,
 50.0,
 30.0,
 200.0,
 130.0,
 140.0,
 40.0,
 50.0,
 250.0,
 40.0,
 560.0,
 360.0,
 970.0,
 440.0,
 200.0,
 490.0,
 120.0,
 90.0,
 370.0,
 400.0,
 480.0,
 880.0,
 1440.0,
 810.0,
 20.0,
 80.0,
 140.0,
 280.0,
 390.0,
 320.0,
 360.0,
 100.0,
 300.0,
 120.0,
 250.0,
 400.0,
 80.0,
 50.0,
 50.0,
 110.0,
 220.0,
 70.0,
 30.0,
 80.0,
 40.0,
 90.0,
 110.0,
 90.0,
 280.0,
 50.0,
 510.0,
 1070.0,
 600.0,
 410.0,
 430.0,
 430.0,
 100.0,
 330.0,
 290.0,
 710.0,
 650.0,
 170.0,
 640.0,
 410.0,
 210.0,
 70.0,
 220.0,
 570.0,
 270.0,
 350.0,
 200.0,
 40.0,
 310.0,
 430.0,
 600.0,
 770.0,
 470.0,
 400.0,
 600.0,
 870.0,
 1200.0,
 170.0,
 150.0,
 190.0,
 450.0,
 200.0,
 70.0,
 390.0,
 100.0,
 40.0,
 30.0,
 70.0,
 150.0,
 150.0,
 40.0,
 400.0,
 50.0,
 530.0,
 830.0,
 340.0,
 170.0,
 290.0,
 210.0,
 390.0,
 760.0,
 310.0,
 430.0,
 450.0,
 510.0,
 460.0,
 280.0,
 460.0,
 980.0,
 240.0,
 1180.0,
 150.0,
 200.0,
 250.0,
 560.0,
 30.0,
 430.0,
 160.0,
 220.0,
 40.0,
 70.0,
 40.0,
 140.0,
 40.0,
 180.0,
 180.0,
 540.0,
 850.0,
 490.0,
 360.0,
 150.0,
 400.0,
 810.0,
 1170.0,
 30.0,
 100.0,
 340.0,
 310.0,
 310.0,
 580.0,
 940.0,
 90.0,
 110.0,
 70.0,
 260.0,
 60.0,
 470.0,
 500.0,
 410.0,
 750.0,
 360.0,
 50.0,
 110.0,
 70.0,
 30.0,
 60.0,
 70.0,
 50.0,
 50.0,
 380.0,
 430.0,
 420.0,
 610.0,
 780.0,
 780.0,
 90.0,
 30.0,
 30.0,
 20.0,
 340.0,
 660.0,
 840.0,
 120.0,
 60.0,
 220.0,
 930.0,
 380.0,
 340.0,
 30.0,
 20.0,
 50.0,
 1110.0,
 180.0,
 430.0,
 80.0,
 120.0,
 350.0,
 420.0,
 550.0,
 470.0,
 280.0,
 1440.0,
 320.0,
 330.0,
 280.0,
 330.0,
 140.0,
 220.0,
 1530.0,
 130.0,
 130.0,
 50.0,
 1410.0,
 390.0,
 110.0,
 1090.0,
 470.0,
 330.0,
 300.0,
 1000.0,
 550.0,
 640.0,
 260.0,
 350.0,
 40.0,
 710.0,
 80.0,
 270.0,
 140.0,
 230.0,
 170.0,
 600.0,
 40.0,
 140.0,
 60.0,
 110.0,
 30.0,
 110.0,
 220.0,
 210.0,
 140.0,
 370.0,
 40.0,
 70.0,
 560.0,
 540.0,
 260.0,
 310.0,
 400.0,
 470.0,
 780.0,
 1470.0,
 310.0,
 290.0,
 530.0,
 290.0,
 380.0,
 720.0,
 80.0,
 440.0,
 260.0,
 50.0,
 130.0,
 180.0,
 60.0,
 660.0,
 220.0,
 1130.0,
 540.0,
 280.0,
 120.0,
 560.0,
 330.0,
 1140.0,
 150.0,
 60.0,
 160.0,
 390.0,
 60.0,
 350.0,
 150.0,
 220.0,
 140.0,
 150.0,
 70.0,
 220.0,
 50.0,
 450.0,
 830.0,
 50.0,
 100.0,
 80.0,
 30.0,
 160.0,
 60.0,
 270.0,
 40.0,
 50.0,
 60.0,
 190.0,
 80.0,
 40.0,
 80.0,
 40.0,
 50.0,
 60.0,
 30.0,
 200.0,
 130.0,
 80.0,
 40.0,
 100.0,
 40.0,
 830.0,
 260.0,
 320.0,
 30.0,
 40.0,
 510.0,
 410.0,
 450.0,
 990.0,
 320.0,
 60.0,
 790.0,
 30.0,
 300.0,
 800.0,
 590.0,
 80.0,
 210.0,
 60.0,
 220.0,
 40.0,
 200.0,
 30.0,
 330.0,
 1340.0,
 180.0,
 100.0,
 250.0,
 150.0,
 40.0,
 170.0,
 30.0,
 790.0,
 490.0,
 280.0,
 560.0,
 320.0,
 520.0,
 320.0,
 410.0,
 130.0,
 220.0,
 40.0,
 250.0,
 30.0,
 40.0,
 580.0,
 420.0,
 280.0,
 40.0,
 630.0,
 260.0,
 60.0,
 80.0,
 310.0,
 370.0,
 180.0,
 570.0,
 30.0,
 400.0,
 320.0,
 170.0,
 130.0,
 40.0,
 790.0,
 700.0,
 90.0,
 330.0,
 500.0,
 550.0,
 470.0,
 310.0,
 1810.0,
 870.0,
 730.0,
 30.0,
 180.0,
 70.0,
 70.0,
 140.0,
 100.0,
 270.0,
 290.0,
 340.0,
 230.0,
 70.0,
 90.0,
 340.0,
 230.0,
 40.0,
 40.0,
 70.0,
 50.0,
 110.0,
 130.0,
 410.0,
 690.0,
 360.0,
 440.0,
 450.0,
 520.0,
 850.0,
 50.0,
 30.0,
 70.0,
 470.0,
 180.0,
 150.0,
 200.0,
 320.0,
 530.0,
 250.0,
 110.0,
 190.0,
 80.0,
 130.0,
 470.0,
 120.0,
 450.0,
 1130.0,
 290.0,
 30.0,
 530.0,
 1080.0,
 330.0,
 420.0,
 640.0,
 500.0,
 460.0,
 860.0,
 140.0,
 310.0,
 160.0,
 90.0,
 30.0,
 50.0,
 170.0,
 30.0,
 40.0,
 490.0,
 410.0,
 100.0,
 70.0,
 550.0,
 380.0,
 500.0,
 210.0,
 90.0,
 480.0,
 40.0,
 360.0,
 50.0,
 130.0,
 150.0,
 380.0,
 20.0,
 40.0,
 130.0,
 60.0,
 50.0,
 960.0,
 460.0,
 450.0,
 520.0,
 1300.0,
 180.0,
 40.0,
 40.0,
 620.0,
 220.0,
 70.0,
 190.0,
 30.0,
 210.0,
 50.0,
 50.0,
 60.0,
 50.0,
 110.0,
 160.0,
 40.0,
 160.0,
 150.0,
 50.0,
 60.0,
 90.0,
 300.0,
 550.0,
 30.0,
 60.0,
 50.0,
 710.0,
 180.0,
 470.0,
 380.0,
 960.0,
 330.0,
 400.0,
 620.0,
 390.0,
 330.0,
 1370.0,
 510.0,
 250.0,
 610.0,
 330.0,
 270.0,
 50.0,
 40.0,
 160.0,
 100.0,
 100.0,
 470.0,
 110.0,
 290.0,
 140.0,
 30.0,
 700.0,
 670.0,
 30.0,
 380.0,
 940.0,
 60.0,
 310.0,
 440.0,
 320.0,
 310.0,
 440.0,
 760.0,
 290.0,
 710.0,
 30.0,
 450.0,
 230.0,
 70.0,
 1300.0,
 190.0,
 30.0,
 50.0,
 530.0,
 150.0,
 60.0,
 40.0,
 220.0,
 370.0,
 990.0,
 390.0,
 1070.0,
 410.0,
 590.0,
 800.0,
 980.0,
 470.0,
 310.0,
 1410.0,
 1010.0,
 250.0,
 30.0,
 200.0,
 640.0,
 480.0,
 780.0,
 320.0,
 200.0,
 410.0,
 40.0,
 80.0,
 410.0,
 490.0,
 400.0,
 420.0,
 620.0,
 360.0,
 60.0,
 210.0,
 430.0,
 450.0,
 220.0,
 140.0,
 50.0,
 240.0,
 660.0,
 380.0,
 310.0,
 180.0,
 240.0,
 50.0,
 450.0,
 220.0,
 320.0,
 240.0,
 50.0,
 490.0,
 50.0,
 810.0,
 590.0,
 540.0,
 460.0,
 530.0,
 780.0,
 400.0,
 1010.0,
 340.0,
 300.0,
 300.0,
 130.0,
 130.0,
 410.0,
 1050.0,
 210.0,
 80.0,
 60.0,
 180.0,
 180.0,
 70.0,
 50.0,
 150.0,
 40.0,
 20.0,
 30.0,
 70.0,
 360.0,
 180.0,
 50.0,
 30.0,
 20.0,
 120.0,
 180.0,
 600.0,
 170.0,
 170.0,
 60.0,
 880.0,
 530.0,
 440.0,
 430.0,
 850.0,
 1250.0,
 140.0,
 240.0,
 80.0,
 20.0,
 1130.0,
 140.0,
 70.0,
 40.0,
 310.0,
 330.0,
 50.0,
 290.0,
 190.0,
 50.0,
 40.0,
 20.0,
 70.0,
 40.0,
 690.0,
 100.0,
 330.0,
 150.0,
 350.0,
 250.0,
 600.0,
 190.0,
 380.0,
 380.0,
 590.0,
 580.0,
 600.0,
 1010.0,
 180.0,
 290.0,
 460.0,
 490.0,
 270.0,
 350.0,
 440.0,
 100.0,
 140.0,
 540.0,
 60.0,
 90.0,
 530.0,
 110.0,
 100.0,
 40.0,
 480.0,
 370.0,
 150.0,
 410.0,
 180.0,
 250.0,
 50.0,
 110.0,
 320.0,
 420.0,
 150.0,
 370.0,
 310.0,
 920.0,
 590.0,
 100.0,
 20.0,
 30.0,
 520.0,
 420.0,
 30.0,
 450.0,
 30.0,
 220.0,
 340.0,
 40.0,
 70.0,
 120.0,
 180.0,
 690.0,
 990.0,
 970.0,
 450.0,
 730.0,
 510.0,
 430.0,
 560.0,
 430.0,
 320.0,
 1180.0,
 420.0,
 850.0,
 1270.0,
 400.0,
 320.0,
 770.0,
 420.0,
 740.0,
 250.0,
 790.0,
 100.0,
 300.0,
 420.0,
 390.0,
 630.0,
 1360.0,
 680.0,
 180.0,
 490.0,
 40.0,
 380.0,
 30.0,
 390.0,
 30.0,
 620.0,
 630.0,
 360.0,
 160.0,
 210.0,
 90.0,
 200.0,
 1030.0,
 710.0,
 230.0,
 300.0,
 480.0,
 540.0,
 530.0,
 90.0,
 190.0,
 870.0,
 170.0,
 260.0,
 310.0,
 300.0,
 280.0,
 480.0,
 350.0,
 80.0,
 170.0,
 40.0,
 420.0,
 220.0,
 200.0,
 120.0,
 80.0,
 50.0,
 300.0,
 30.0,
 90.0,
 330.0,
 280.0,
 340.0,
 80.0,
 30.0,
 50.0,
 30.0,
 350.0,
 20.0,
 220.0,
 130.0,
 70.0,
 170.0,
 30.0,
 30.0,
 920.0,
 430.0,
 350.0,
 320.0,
 360.0,
 1060.0,
 180.0,
 500.0,
 60.0,
 90.0,
 410.0,
 90.0,
 60.0,
 30.0,
 30.0,
 840.0,
 1270.0,
 150.0,
 440.0,
 430.0,
 570.0,
 620.0,
 790.0,
 60.0,
 310.0,
 440.0,
 470.0,
 760.0,
 2140.0,
 350.0,
 320.0,
 570.0,
 300.0,
 280.0,
 60.0,
 860.0,
 110.0,
 560.0,
 1080.0,
 50.0,
 50.0,
 30.0,
 20.0,
 30.0,
 20.0,
 30.0,
 20.0,
 30.0,
 230.0,
 120.0,
 70.0,
 380.0,
 50.0,
 30.0,
 70.0,
 310.0,
 480.0,
 370.0,
 430.0,
 80.0,
 480.0,
 320.0,
 860.0,
 610.0,
 30.0,
 30.0,
 90.0,
 960.0,
 420.0,
 550.0,
 820.0,
 310.0,
 290.0,
 220.0,
 980.0,
 610.0,
 70.0,
 480.0,
 460.0,
 580.0,
 1110.0,
 1040.0,
 630.0,
 600.0,
 300.0]
RR_x = peaklist[1:] #Remove the first entry, because first interval is assigned to the second beat.
RR_y = RR_list[1:] #Y-values are equal to interval lengths

x = len(RR_x)
y = len(RR_y)
print(x)
print(y)


# In[ ]:





# In[ ]:





# In[ ]:





# In[46]:


#Create evenly spaced timeline starting at the second peak, its endpoint and length equal to position of last peak
RR_x_new = np.linspace(RR_x[0],RR_x[-1],RR_x[-1]) 


# In[47]:


f = interp1d(RR_x, RR_y, kind='cubic') #Interpolate the signal with cubic spline interpolation


# Note that the time series does not start at the first peak, but at the sample position of the second R-peak. Because we work with the intervals, the first interval is available at the second peak.
# We can now use the created function f() to find the y value of any x-position within our signal range:

# In[48]:


print( f(250))
#Returns 997.619845418, the Y value at x=250


# Simlarly, we can pass our entire timeseries RR_x_new to the function and plot it:

# In[49]:


plt.title("Original and Interpolated Signal")
plt.plot(RR_x, RR_y, label="Original", color='blue')
plt.plot(RR_x_new, f(RR_x_new), label="Interpolated", color='red')
plt.legend()
plt.show()


# Now to find the frequencies that make up the interpolated signal, use numpy’s fast fourier transform np.fft.fft() method, calculate sample spacing, convert sample bins to Hz and plot:

# In[50]:


dataset = pd.read_csv("Bunlabelledtest__103_1305031931979_C_Output_mono.csv")

#Calculate moving average with 0.75s in both directions, then append do dataset
hrw = 0.75 #One-sided window size, as proportion of the sampling frequency
fs = 100 #The example dataset was recorded at 100Hz
#Set variables
#trunckate = dataset[:2406]
n = len(dataset.hart) #Length of the signal
print(n)
n


# In[ ]:





# In[51]:


frq = np.fft.fftfreq(len(dataset.hart), d=((1/fs))) #divide the bins into frequency categories
frq = frq[range(int(n/2))] #Get single side of the frequency range

#Do FFT
Y = np.fft.fft(f(RR_x_new))/n #Calculate FFT
print(Y.size)
Y = Y[range(int(n/2))] #Return one side of the FFT
print(Y.size)

#Plot
plt.title("Frequency Spectrum of Heart Rate Variability")
plt.xlim(0,0.6) #Limit X axis to frequencies of interest (0-0.6Hz for visibility, we are interested in 0.04-0.5)
plt.ylim(0, 50) #Limit Y axis for visibility
plt.plot(frq, abs(Y)) #Plot it
plt.xlabel("Frequencies in Hz")
plt.show()


# Nice! You can clearly see the LF and HF frequency peaks in the signal.
# The last thing remaining is to integrate the area under curve at the LF (0.04 – 0.15Hz) and HF (0.16 – 0.5Hz) frequency bands. We need to find the data points corresponding to the frequency range we’re interested in. During the FFT we calculated the one-sided frequency range frq, so we can search this for the required data point positions.

# In[52]:


lf = np.trapz(abs(Y[(frq>=0.04) & (frq<=0.15)])) #Slice frequency spectrum where x is between 0.04 and 0.15Hz (LF), and use NumPy's trapezoidal integration function to find the area
print("LF:", lf)

hf = np.trapz(abs(Y[(frq>=0.16) & (frq<=0.5)])) #Do the same for 0.16-0.5Hz (HF)
print("HF:", hf)


# These are the areas under the frequency plot at the frequency spectra of interest. Remember from the theory that HF is related to breathing and LF to short-term blood pressure regulation. The measures have also been implicated in increased mental activity.

# In[ ]:




